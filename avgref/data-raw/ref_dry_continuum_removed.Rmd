---
title: "ref_dry"
author: "Kangyu So"
date: "2023-11-01"
output: html_document
---

I have a CSV file which contains data on the spectral reflectance of post-dried soil samples between the wavelengths 350 nm and 2500 nm in increments of 1 nm. The soil samples were collected from the Hudson Bay Lowlands.

To increase the shareability of the data I will first read the data set. I will then convert the data set to an `.RData` file and then document it. This will enable the data set to be bundled with package `ContinuumRemoval`.

Install and load the package needed to preprocess the data:
```{r}
install.packages("prospectr")
library(prospectr)
```

Read the CSV file as a data frame:
```{r}
data <- read.csv("data-raw/SoilReflectanceDry_v01.csv")
```

The data frame consists of 2151 observations of 433 variables. Get a summary of the data frame:
```{r}
summary(data)
```

The data was collected by Kangyu So, Dr. Alemu Gonsamo, and Dr. Cheryl A. Rogers from McMaster University. The data was collected from 18 sites near the Cree First Nations communities in the Hudson Bay Lowlands region of northern Ontario, Canada. The data was collected during the month of July 2023 and spectral measurements were collected during the month of August 2023. 

The reflectance spectra is not normalized so I will calculate continuum removal for the data frame:
```{r}
ref_dry <- as.data.frame(apply(data[,-1], MARGIN=2, FUN =continuumRemoval, wav = data$Wavelength))
ref_dry <- cbind(Wavelength = data$Wavelength, ref_dry)
```

At this stage, the data is arranged so that its definitions are composed of the wavelength and the ID of all of the soil samples, totaling 433 definitions. There are too many data definitions to explain right now, but after the avgref function is applied, there will only be two data definitions remaining which are Sample_ID and Reflectance.

Load the summary of the new data frame and ensure that there is no missing data:
```{r}
summary(ref_dry)
```

Save to data folder:
```{r}
usethis::use_data(ref_dry, overwrite = TRUE)
```
