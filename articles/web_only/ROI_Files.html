<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="carbcontpred">
<title>Extraction and Visualization of ROI Data Files • carbcontpred</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Extraction and Visualization of ROI Data Files">
<meta property="og:description" content="carbcontpred">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">carbcontpred</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/carbcontpred-vignette.html">carbcontpred-vignette</a>
    <a class="dropdown-item" href="../../articles/web_only/Background_Information.html">Background Information</a>
    <a class="dropdown-item" href="../../articles/web_only/ROI_Files.html">Extraction and Visualization of ROI Data Files</a>
    <a class="dropdown-item" href="../../articles/web_only/limitation_reuse.html">Limitations and Reuse Potential</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KangyuSo/carbcontpred/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extraction and Visualization of ROI Data Files</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KangyuSo/carbcontpred/blob/HEAD/vignettes/web_only/ROI_Files.Rmd" class="external-link"><code>vignettes/web_only/ROI_Files.Rmd</code></a></small>
      <div class="d-none name"><code>ROI_Files.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="extracting-an-roi-data-file-for-mappred">Extracting an ROI data file for mappred<a class="anchor" aria-label="anchor" href="#extracting-an-roi-data-file-for-mappred"></a>
</h2>
<div class="section level3">
<h3 id="instructions">Instructions<a class="anchor" aria-label="anchor" href="#instructions"></a>
</h3>
<p>The <code>mappred</code> function uses a file containing spatial
information and spectral reflectance values of a Region of Interest
(ROI). An ROI is a selected sample from a raster in the image processing
and analysis software ENVI <span class="citation">(NV5 Geospatial
nd-a)</span>. ENVI can be downloaded from the NV5 Geospatial <a href="https://www.nv5geospatialsoftware.com/" class="external-link">website</a>. A raster is a
common type of data used in ENVI which is generated from a data set.
Rasters are a continuous matrix or array of data numbers which can
represent many different types of information. The raster that will be
generated and used for the <code>carbcontpred</code> package will
represent the spectral reflectance information <span class="citation">(NV5 Geospatial nd-b)</span>.</p>
<p>To extract an ROI data file for <code>mappred</code> you will first
download a data set in the form of a map image and open it on ENVI. This
data set will contain several spectral bands that cover specific
wavelength ranges. It is important that the wavelength range of the
spectral bands in the data set you use and the wavelength ranges you set
during the preprocessing of data for <code>mappred</code> are
similar.</p>
<p>You will then generate a raster of spectral reflectance from this
data file using the Band Math tool in ENVI which can be found in the
Band Algera folder in the Toolbox. Band Math will ask for an equation
prompt which you will create using the spectral bands you chose to use.
In Band Math, the equation will be written as the following:</p>
<p>[1]<span class="math display">\[\begin{equation} \label{eq:1}((B[a] +
B[b] + … B[z])/n)\end{equation}\]</span></p>
<p><em>where B[a, b, … z] are the bands you chose to use and n is the
total number of chosen bands.</em></p>
<p>Applying this equation in Band Math will generate a raster showing
the average reflectance in the wavelength region that your chosen
spectral bands cover. You will now create an ROI using the Region of
Interest (ROI) tool at the top ribbon. You will select the New ROI
option within this tool and then create a polygon out of your area of
interest. Once this is done you will go to File in the tool, select
Export, and then pick Export to CSV. This will output the spatial and
reflectance information of points in your ROI as a data table which you
will use in <code>mappred</code>. Most of the columns in the data table
consist of spatial information but the average reflectance value will be
stored in the <code>B1</code> column.</p>
</div>
<div class="section level3">
<h3 id="example-of-application">Example of Application<a class="anchor" aria-label="anchor" href="#example-of-application"></a>
</h3>
<p>To extract <code>Reflectance_ROI.csv</code> which is the example ROI
data file in the <code>carbcontpred</code> package we downloaded a data
set from the Moderate Resolution Imaging Spectroradiometer (MODIS)
satellite operated by the National Aeronautics and Space Administration
(NASA). Specifically, we used MODIS/Terra Surface Reflectance Daily L2G
Global 1km and 500m SIN Grid data set. This data set provides an
estimate of surface spectral reflectance at the ground level. More
information about this data set can be found <a href="https://ladsweb.modaps.eosdis.nasa.gov/missions-and-measurements/products/MOD09GA" class="external-link">here</a>.
For this example, we used the data captured on October 3, 2022. We
downloaded this data from the NASA Earthdata Search <a href="https://search.earthdata.nasa.gov/search" class="external-link">website</a> under the ID
MOD09GA.A2022276.h13v03.061.2022278035218. We chose this date because it
is within the same year that the soil samples were collected. Although
the soil samples were collected in July, we chose October because it is
before snowfall and after the growing season in northern Ontario, which
means that the spectral reflectance of the soil is less obstructed by
snow or vegetation <span class="citation">(National Aeronautics and
Space Administration nd)</span>. We opened the downloaded file on ENVI
and used Data Manager at the top ribbon to load a true colour composite
of the file. Using the data set <a href="https://ladsweb.modaps.eosdis.nasa.gov/missions-and-measurements/products/MOD09GA" class="external-link">website</a>
for reference, we generated a true colour composite by putting Band 1 in
the red channel, Band 4 in the green channel, and Band 3 in the blue
channel <span class="citation">(Land Processes Distributed Active
Archive Center nd)</span>.</p>
<p><img src="envi_true_colour.png" style="width:75.0%"></p>
<p><strong>Figure 1.</strong> <em>A true colour composite of the Hudson
Bay Lowlands. The image is generated from ENVI using the data file
MOD09GA.A2022276.h13v03.061.2022278035218 from NASA. The composite was
generated by using Band 1 in the red channel, Band 4 in the green
channel, and Band 3 in the blue channel.</em></p>
<p>We generated a raster of spectral reflectance from this data file
using Band Math and all 7 of the spectral bands in the file. This is
because the 7 bands together cover a wavelength range from 620 nm to
2155 nm, which is a majority of the visible-near infrared (vis-NIR)
region as shown on this <a href="https://lpdaac.usgs.gov/products/mod09gav006/" class="external-link">website</a> <span class="citation">(Land Processes Distributed Active Archive Center
nd)</span>. Thus, our equation for Band Math is constructed as
follows:</p>
<p>[2]<span class="math display">\[\begin{equation} \label{eq:2}((B1 +
B2 + B3 + B4 + B5 + B6 + B7)/7)\end{equation}\]</span></p>
<p><em>where B1 to B7 are Bands 1 to 7 from the
MOD09GA.A2022276.h13v03.061.2022278035218 data file.</em></p>
<p>After generating a raster of spectral reflectance from this data file
using the Band Math tool, we used the Region of Interest (ROI) tool to
create an ROI that covers the area around our soil sample sites as well
as nearby peatlands.</p>
<p><img src="envi_raster_reflectance.png" style="width:75.0%"></p>
<p><strong>Figure 2.</strong> <em>A raster of the Hudson Bay Lowlands
showing the average reflectance value over a wavelength range of 620 nm
to 2155 nm. The blue area represents the Region of Interest (ROI). The
image is generated from ENVI using the data file
MOD09GA.A2022276.h13v03.061.2022278035218 from NASA. The raster was
generated by the average value of Bands 1 to 7 in the data
file.</em></p>
<p>Finally, we used Export to CSV to extract a data table containing the
spatial and reflectance information of points in our ROI. The data table
can be found in <code>Reflectance_ROI.csv</code> in the
<code>carbcontpred</code> package. <strong>Table 1</strong> shows the
first 6 rows of the <code>ROI_Predicted_Carbon.csv</code> data file.</p>
<p><strong>Table 1.</strong> <em>The first 6 rows of the</em>
<code>ROI_Predicted_Carbon.csv</code> <em>data file. The <code>B1</code>
column represents the average reflectance values of the spatial points
over a wavelength range of 620 nm to 2155 nm.</em></p>
<table class="table">
<thead><tr class="header">
<th align="right">X..File.X</th>
<th align="right">File.Y</th>
<th align="right">Map.X</th>
<th align="right">Map.Y</th>
<th align="right">Lat</th>
<th align="right">Lon</th>
<th align="right">B1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">91</td>
<td align="right">1677</td>
<td align="right">-5517591</td>
<td align="right">5894728</td>
<td align="right">53.01250</td>
<td align="right">-82.47585</td>
<td align="right">68.85428</td>
</tr>
<tr class="even">
<td align="right">92</td>
<td align="right">1677</td>
<td align="right">-5517128</td>
<td align="right">5894728</td>
<td align="right">53.01250</td>
<td align="right">-82.46892</td>
<td align="right">72.12532</td>
</tr>
<tr class="odd">
<td align="right">90</td>
<td align="right">1677</td>
<td align="right">-5518054</td>
<td align="right">5894728</td>
<td align="right">53.01250</td>
<td align="right">-82.48277</td>
<td align="right">68.85428</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">1678</td>
<td align="right">-5518518</td>
<td align="right">5894264</td>
<td align="right">53.00833</td>
<td align="right">-82.48174</td>
<td align="right">72.87362</td>
</tr>
<tr class="odd">
<td align="right">90</td>
<td align="right">1678</td>
<td align="right">-5518054</td>
<td align="right">5894264</td>
<td align="right">53.00833</td>
<td align="right">-82.47481</td>
<td align="right">72.87362</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">1678</td>
<td align="right">-5517591</td>
<td align="right">5894264</td>
<td align="right">53.00833</td>
<td align="right">-82.46789</td>
<td align="right">72.12532</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-the-output-of-mappred">Visualizing the output of mappred<a class="anchor" aria-label="anchor" href="#visualizing-the-output-of-mappred"></a>
</h2>
<div class="section level3">
<h3 id="instructions-1">Instructions<a class="anchor" aria-label="anchor" href="#instructions-1"></a>
</h3>
<p>The <code>mappred</code> function will output a file similar to the
ROI data file you used as the input. The difference is that the spectral
reflectance values under the <code>B1</code> column are now replaced
with the predicted organic carbon content. We can visualize the
predicted organic carbon content on a map through the geographic
information system software ArcGIS Pro. ArcGIS Pro can be downloaded
from the Esri <a href="https://www.esri.com/en-us/arcgis/products/arcgis-pro/overview" class="external-link">website</a>.</p>
<p>You will open ArcGIS Pro and set a basemap to whatever you choose and
then upload your output ROI data file as a standalone table in the
Contents pane. You will then select the file and use the Display XY Data
action to create a point feature class based on the x and y values from
your file. To do this, your parameters for the X Field, Y Field, and Z
Field will be your Lon, Lat, and your predicted organic carbon content
(Usually the B1 column). The rest of the parameters can be customized
according to your preferences. This will create a layer of points over
your ROI based on the spatial information provided in the data file.
Next, you will use Conversion Tools and select Point to Raster (Feature
to Raster will also work). The prompt will ask for your Input Features
and your Value field, which will be your point feature class and your
predicted organic carbon content values (Usually the B1 column)
respectively. The rest of the parameters can be customized according to
your preferences. The output of this map is a raster similar to the one
for the spectral reflectance values in the previous section, except it
is for the predicted organic carbon content instead of reflectance.</p>
</div>
<div class="section level3">
<h3 id="example-of-application-1">Example of Application<a class="anchor" aria-label="anchor" href="#example-of-application-1"></a>
</h3>
<p>The output using the example in the <code>carbcontpred</code> package
is <code>ROI_Predicted_Carbon.csv</code>. We opened ArcGIS Pro and
selected the basemap to be Imagery. We uploaded
<code>ROI_Predicted_Carbon.csv</code> as a standalone table in the
Contents pane and then used the Display XY Data action to create a point
feature class with Lon, Lat, and the B1 column as the X Field, Y Field,
and Z Field respectively while leaving the default settings for
everything else. We then used Point to Raster and selected the point
feature class and the B1 column for the Input Features and the Value
field respectively. We left the default selection for Cell assignment
type, Priority field, and Cellsize, which were Most frequent, NONE, and
0.008 respectively. The output of this map is shown in <strong>Figure
3</strong>.</p>
<p><img src="arcgis_raster_carbon.png" style="width:75.0%"></p>
<p><strong>Figure 3.</strong> <em>A raster of the Hudson Bay Lowlands
showing the predicted organic carbon content in percent dry mass of the
Region of Interest (ROI). The image is generated using the data file
MOD09GA.A2022276.h13v03.061.2022278035218 from NASA and the
<code>carbcontpred</code> package.</em></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-landmod0" class="csl-entry">
Land Processes Distributed Active Archive Center. nd. <span>“MOD09GA
V006.”</span> <a href="https://lpdaac.usgs.gov/products/mod09gav006/" class="external-link uri">https://lpdaac.usgs.gov/products/mod09gav006/</a>.
</div>
<div id="ref-nasamod0" class="csl-entry">
National Aeronautics and Space Administration. nd.
<span>“MOD09GA.A2022276.h13v03.061.2022278035218.”</span> <a href="https://search.earthdata.nasa.gov/search" class="external-link uri">https://search.earthdata.nasa.gov/search</a>.
</div>
<div id="ref-nv5roi" class="csl-entry">
NV5 Geospatial. nd-a. <span>“Region of Interest (ROI) Tool.”</span> <a href="https://www.nv5geospatialsoftware.com/docs/RegionOfInterestTool.html" class="external-link uri">https://www.nv5geospatialsoftware.com/docs/RegionOfInterestTool.html</a>.
</div>
<div id="ref-nv5raster" class="csl-entry">
———. nd-b. <span>“What Is Raster Data?”</span> <a href="https://www.nv5geospatialsoftware.com/Support/Maintenance-Detail/ArtMID/13350/ArticleID/17307" class="external-link uri">https://www.nv5geospatialsoftware.com/Support/Maintenance-Detail/ArtMID/13350/ArticleID/17307</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kangyu So.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
